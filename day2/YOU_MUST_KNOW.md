# YOU_MUST_KNOW

블록체인 코어 엔지니어로 성장하려면 러스트의 소유권과 빌림 규칙을 생활 습관처럼 이해해야 합니다. 아래 개념을 14살 학생에게 설명한다는 마음으로 쉽게 정리했으니 꼭 숙지하세요.

## 1. 소유권과 빌림의 기본 생각
- 러스트에서 값은 항상 **주인(ownership)**이 있습니다. `String` 같은 힙 데이터는 한 번에 한 변수만 완전히 소유할 수 있습니다.
- 누군가가 값을 잠깐 쓰고 싶다면 **빌림(borrowing)**을 해야 합니다. 빌림은 단지 그 값의 주소를 가리키는 "참조(reference)"를 받는 것과 같습니다.
- 빌린 사람은 값을 다 쓰고 나면 돌려줘야 하며, 원래 주인은 값이 안전하게 돌아올 때까지 규칙을 지켜야 합니다.

## 2. 불변 참조와 가변 참조
- **불변 참조(immutable reference)**: 값을 바꾸지 않는 약속으로 빌리는 방법입니다. 여러 명이 동시에 빌려도 서로 간섭하지 않으니 안전합니다.
- **가변 참조(mutable reference)**: 값을 바꾸고 싶은 사람이 빌리는 방법입니다. 하지만 동시에 두 명이 가변 참조를 가지면 서로 수정하려고 싸울 수 있으므로, 러스트는 한 번에 딱 한 개의 가변 참조만 허용합니다.
- 이 규칙 덕분에 C/C++에서 발생하는 데이터 경합(data race)이나 예측 불가능한 버그를 미리 막을 수 있습니다.

## 3. 슬라이스가 안전한 이유
- 슬라이스(slice)는 "배열의 일부를 창문처럼 들여다보는" 참조입니다. 실제 데이터를 복사하지 않고, 시작 주소와 길이 정보만 담고 있습니다.
- 슬라이스가 살아 있는 동안에는 원본 데이터도 반드시 살아 있어야 합니다. 러스트 컴파일러는 이를 확인하기 위해 라이프타임(lifetime) 규칙을 체크합니다.

## 4. 라이프타임 표기의 의미
- `'a` 같은 기호는 라이프타임을 나타내며, "이 참조는 최소한 `'a` 기간 동안 살아 있어야 한다"는 약속입니다.
- 대부분의 경우 컴파일러가 자동으로 추론하지만, 함수에서 여러 참조를 반환하거나 구조체에 참조를 저장할 때는 명시해야 할 때가 있습니다.

## 5. 블록체인 상태 업데이트와 빌림
- 블록체인 노드는 전 세계 참가자들의 거래를 모아 상태(state)를 업데이트합니다. 상태를 읽는 작업은 불변 참조처럼 동시에 많이 일어날 수 있지만, 상태를 수정하는 작업은 가변 참조처럼 철저히 관리되어야 합니다.
- Solana 같은 고성능 체인에서도 계정(account) 데이터를 잠깐 빌려 읽거나 수정할 때 이러한 규칙이 적용됩니다. 러스트의 빌림 모델을 이해하면 상태 업데이트 로직을 안전하고 빠르게 작성할 수 있습니다.

이 다섯 가지 원칙을 몸에 익히면, 나중에 등장할 라이프타임 충돌이나 동시성 문제도 당황하지 않고 해결할 수 있습니다.
